<!DOCTYPE html>
<html>
    <head>
		<title>Groove Writer</title>
		
		<meta name="viewport" content="width=985, initial-scale=1.25">
		
		<!--   Other peoples JS libraries    -->
		<!--   midi.js package for sound   -->
		<script src="./js/MIDI/AudioDetect.js" type="text/javascript"></script>
		<script src="./js/MIDI/LoadPlugin.js" type="text/javascript"></script>
		<script src="./js/MIDI/Plugin.js" type="text/javascript"></script>
		<script src="./js/MIDI/Player.js" type="text/javascript"></script>
		<script src="./js/Window/DOMLoader.XMLHttp.js" type="text/javascript"></script>
		<!-- jasmid package midi package required by midi.js above -->
		<script src="./inc/jasmid/stream.js"></script>
		<script src="./inc/jasmid/midifile.js"></script>
		<script src="./inc/jasmid/replayer.js"></script>
		<!-- jsmidgen -->
		<script src="./js/jsmidgen.js" type="text/javascript"></script>
		<!-- extras -->
		<script src="./inc/Base64.js" type="text/javascript"></script>
		<script src="./inc/base64binary.js" type="text/javascript"></script>
		<!-- script to render ABC to an SVG image -->
		<script type="text/javascript" src="./js/abc2svg-c.js"></script>
		<!-- script to shorten URLs from goo.gl -->
		<script src="https://apis.google.com/js/client.js"></script>
		<!-- script for sharing to social sites -->
		<script src="js/share.min.js"></script>
		
		<!--   our custom JS  -->
		<script src="js/groove_writer.js"></script>
		
	    <link rel="stylesheet" type="text/css" href="css/groove_writer.css">
    </head>
    <body>
	    <div class="nonPrintable">
			<div class="heading1">Groove Writer</div>
			<a class="subdivision" id="4ths"  href="?Div=4"  onClick="event.preventDefault(); changeDivision(4)"><sup>1</sup>/<sub>4</sub> &#9834;</a>
			<a class="subdivision" id="8ths"  href="?Div=8"  onClick="event.preventDefault(); changeDivision(8)"><sup>1</sup>/<sub>8</sub> &#9834;&#9834;</a>
			<a class="subdivision" id="16ths" href="?Div=16" onClick="event.preventDefault(); changeDivision(16)"><sup>1</sup>/<sub>16</sub> &#9835;</a>
			<a class="subdivision" id="32ths" href="?Div=32" onClick="event.preventDefault(); changeDivision(32)"><sup>1</sup>/<sub>32</sub> &#9835;&#9835;</a>
			<a class="subdivision" id="12ths"  href="?Div=12" onClick="event.preventDefault(); changeDivision(12)"><sup>1</sup>/<sub>8 triplets</sub> &#9834;&#9834;</a>
			<a class="subdivision" id="24ths" href="?Div=24" onClick="event.preventDefault(); changeDivision(24)"><sup>1</sup>/<sub>16 triplets</sub> &#9835;</a>
			<br>
			<select onChange="permutation_menu_change()" id="permutationType" name="permutationType">
				<option value="none" >No Permutation</option>
			</select>
			
			
			<script>
				if(is_touch_device()) {
					document.write('&nbsp;&nbsp;&nbsp;&nbsp;<label><b>Advanced Edit:</b><input type="checkbox" id="advancedEdit" value="advancedEdit"></label>');
				}
			</script>
			<div id="noteInstructions">
			Click on the note bodies to toggle them on and off
			</div>
			
			<div id="musicalInput">
				<script>
					genHTML = HTMLforStaffContainer(1, 0);
					genHTML += HTMLforStaffContainer(2, global_notes_per_measure);
					document.write(genHTML);
				</script>
			</div>
			<div id="buttonsAboveSheetMusic">
				<div class="justifiedDiv">
				<button id="showHideSecondMeasureButton" href="" onClick="event.preventDefault(); showHideSecondMeasure(false, false);">Show/Hide 2nd Measure</button>
				</div>
				<div class="justifiedDiv">
				<button id="showHideStickings" href="" onClick="event.preventDefault(); showHideStickings(false, false);">Show/Hide Stickings</button>
				</div>
				<div class="justifiedDiv">
				<button id="printButton" type="button" onclick="printMusic()">Print/Save Sheet Music</button>
				</div>
				<div class="justifiedDiv">
				<button id="shareSaveButton" href="#" onClick="event.preventDefault(); show_FullURLPopup()">Share/Save Groove</button>
				</div>
			</div>
		</div>  
		<div class="Printable">
			<!-- rendering area -->
			<div id="svgTarget" class="svgTarget">
			<!-- space for the SVG music go display -->
			</div>
		</div>
		<div class="nonPrintable">
		<hr>
			
			<b>Title:</b> <input id="tuneTitle" onChange="create_ABC()" type="text"> &nbsp;
			<b>Author:</b> <input id="tuneAuthor" onChange="create_ABC()"  type="text"> &nbsp;
			<b>Comment:</b> <input id="tuneComments" onChange="create_ABC()"  type="text"> &nbsp;
			<label><b>Legend:</b><input type="checkbox" id="showLegend" onChange="create_ABC()"></label>
			  
			<!-- errors -->
			<br>
			<br>
			<br>
			<p class="warnings">Warnings:
			<div class="warnings" id="diverr"></div>
			
			<div id="playerControl">
				<img alt="Play" title="Play" id="playImage" src="images/grey_play.png">
				<span id="tempoAndProgress">
					<div id="tempo">
						<input type=range min=40 max=240 value=90 id="tempoInput" list="tempoSettings" step=5 onChange="noteHasChanged()" oninput="tempoUpdate(value)">
						<div for=tempo id=tempoOutput>80 bpm</div>
					</div>
					<div id="swingAmount">
						<input type=range min=0 max=50 value=0 id="swingInput" list="swingSettings" step=5 onChange="noteHasChanged()" oninput="swingUpdate(value)">
						<div for=swingAmount id=swingOutput>0% swing</div>
					</div>
				</span>
				<img onClick="repeatMIDI_playback();" alt="Repeat" title="Repeat" id="repeatImage" src="images/repeat.png">
				<br>
				<div id="progress">
					<progress id="MIDIProgress" value="0" max="100"></progress>
				</div>
			</div>	
			<br>
			<button type="button" id="exportMidi" onclick="MIDI_save_as()">Export Midi File</button>
			
			<br>
			<span id="hiddenDescription">
				Groove Writer allows drummers to create and share interesting grooves with  
				WYSIWYG authoring, sheet music creation, and audio playback all in one place.
				Use the Groove Writer to write out new grooves, figure out the groove to your favorite songs,
				or write down the groove to your latest tune.
			</span>
			<p>
			<!-- ABC notation -->
			<A href="" onClick="event.preventDefault(); ShowHideABCResults();">Show/Hide ABC Notation</a>
			<div id="ABC_Results">
				ABC Notation is used for rendering the music.  You can see what is being generated below.   
				You can even edit it.  <br>
				NOTE: whenever the page is modified, the ABC Notation below will be overwritten automatically. <br>
				For more information about ABC Notation go here: <a href="http://abcnotation.com/">http://abcnotation.com/</a>
				<p>
				<textarea id="ABCsource" rows="10" cols="72" ></textarea>
				<br>
				<button type="button" onclick="renderABCtoSVG()">Re-render the music</button>
				<button type="button" onclick="saveABCtoFile()">Save ABC to file</button>
			</div>
		</div>

		
		<!-- context menu that will pop up over notes in advaced edit more -->
		<div class="noteContextMenu">
			<ul id="hhContextMenu" class="list">
				<li onClick='notePopupClick("hh", "off")'>OFF</li>
				<li onClick='notePopupClick("hh","normal")'>Hi-hat normal</li>
				<li onClick='notePopupClick("hh","open")'>Hi-hat open</li>
				<li onClick='notePopupClick("hh","close")'>Hi-hat closed</li>
				<li onClick='notePopupClick("hh","accent")'>Hi-hat accent</li>
				<li onClick='notePopupClick("hh","crash")'>Crash</li>
				<li onClick='notePopupClick("hh","ride")'>Ride</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="snareContextMenu" class="list">
				<li onClick='notePopupClick("snare", "off")'>OFF</li>
				<!-- li onClick='notePopupClick("snare", "normal")'>Snare Normal</li -->
				<li onClick='notePopupClick("snare", "accent")'>Snare Accent</li>
				<li onClick='notePopupClick("snare", "ghost")'>Ghost Note</li>
				<li onClick='notePopupClick("snare", "xstick")'>Cross Stick</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="kickContextMenu" class="list">
				<li onClick='notePopupClick("kick", "off")'>OFF</li>
				<li onClick='notePopupClick("kick", "normal")'>Kick Normal</li>
				<li onClick='notePopupClick("kick", "splash")'>Hi-hat foot</li>
				<li onClick='notePopupClick("kick", "kick_and_splash")'>Kick & Hi-hat splash</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="hhLabelContextMenu" class="list">
				<li onClick='noteLabelPopupClick("hh", "all_off")'>all Hi-hats <b>OFF</b></li>
				<li onClick='noteLabelPopupClick("hh", "all_on")'>all Hi-hats <b>ON</b></li>				
				<li onClick='noteLabelPopupClick("hh", "cancel")'>cancel</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="snareLabelContextMenu" class="list">
				<li onClick='noteLabelPopupClick("snare", "all_off")'>all Snares <b>OFF</b></li>
				<li onClick='noteLabelPopupClick("snare", "all_on")'>all Snares <b>ON</b></li>
				<li onClick='noteLabelPopupClick("snare", "cancel")'>cancel</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="kickLabelContextMenu" class="list">
				<li onClick='noteLabelPopupClick("kick", "all_off")'>all Kicks <b>OFF</b></li>
				<li onClick='noteLabelPopupClick("kick", "all_on")'>all Kicks <b>ON</b></li>
				<li onClick='noteLabelPopupClick("kick", "cancel")'>cancel</li>
			</ul>
		</div>
		<div class="noteContextMenu">
			<ul id="stickingsLabelContextMenu" class="list">
				<li onClick='noteLabelPopupClick("stickings", "all_off")'>all <b>OFF</b></li>
				<li onClick='noteLabelPopupClick("stickings", "alternate")'>alternate</li>
				<li onClick='noteLabelPopupClick("stickings", "all_right")'>all <b>R</b>s</li>
				<li onClick='noteLabelPopupClick("stickings", "all_left")'>all <b>L</b>s</li>
				<li onClick='noteLabelPopupClick("stickings", "cancel")'>cancel</li>
			</ul>
		</div>
		
		
		<!-- this is used by the share/save button, and is hidden by default -->
		<div id="fullURLPopupContainer">
			<div id="fullURLPopup">
				<button id="fullURLCloseButton" onClick="close_FullURLPopup()">&times;</button>
				Use this URL to return with all the notes the way you set them.<br>
				<br>
				<input type="text" id="fullURLTextField"><br>
				<label>Generate Short URL:<input type="checkbox" id="shortenerCheckbox" onchange="shortenerCheckboxChanged()"></label>
				<a href="#" id="fullURLLink">follow link</a>
				<br>
				<br>
				<div id="shareButton"></div>
			</div>
		</div>
			
		<!-- use css to position this to the upper right -->
		<span id="upperRight">
		<a id="interestingGrooves" href="interestingGrooves.html">Interesting Grooves</a>&nbsp;&nbsp;-&nbsp;&nbsp;
		<a id="about" href="about.html">About</a>
		</span>
		<script>
			// set up the page after it has fully loaded
			setMusicStaffWidth();
			window.onload = function () {
				runsOnPageLoad();   // Initialize the notes
			}
		</script>
			
		
    </body>
</html>