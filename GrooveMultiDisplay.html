<!DOCTYPE html>
<html>
    <head>
		<title>Groove Display</title>
		
		<meta name="viewport" content="width=810, initial-scale=1.25">
		
		<!--   Other peoples JS libraries    -->
		<!--   midi.js package for sound   -->
		<script src="./js/MIDI/AudioDetect.js" type="text/javascript"></script>
		<script src="./js/MIDI/LoadPlugin.js" type="text/javascript"></script>
		<script src="./js/MIDI/Plugin.js" type="text/javascript"></script>
		<script src="./js/MIDI/Player.js" type="text/javascript"></script>
		<script src="./js/Window/DOMLoader.XMLHttp.js" type="text/javascript"></script>
		<!-- jasmid package midi package required by midi.js above -->
		<script src="./inc/jasmid/stream.js"></script>
		<script src="./inc/jasmid/midifile.js"></script>
		<script src="./inc/jasmid/replayer.js"></script>
		<!-- jsmidgen -->
		<script src="./js/jsmidgen.js" type="text/javascript"></script>
		<!-- extras -->
		<script src="./inc/Base64.js" type="text/javascript"></script>
		<script src="./inc/base64binary.js" type="text/javascript"></script>
		<!-- script to render ABC to an SVG image -->
		<script type="text/javascript" src="./js/abc2svg-1.js"></script>
		
		<!--   our custom JS  -->
		<script src="js/groove_utils.js"></script>
		
		
	    <link rel="stylesheet" type="text/css" href="css/groove_writer.css">
    </head>
    <body>
	<script>
			var UniqueCounter = 0;  // global
	
	
			function AddGroove(HtmlTagId, GrooveDefinition) {
				var myGrooveUtils = new GrooveUtils();
				UniqueCounter++;
				
				svgTargetId = "svgTarget" + UniqueCounter;
				midiPlayerTargetId = "midiPlayerTarget" + UniqueCounter;
			
				document.getElementById(HtmlTagId).innerHTML = '' +
						'<div id="' + svgTargetId + '" class="svgTarget"></div>\n' +
						'<div id="' + midiPlayerTargetId + '"></div>\n';
						
				// load the groove from the URL data if it was passed in.
				var GrooveData = myGrooveUtils.getGrooveDataFromUrlString(GrooveDefinition);
				var abcNotation = myGrooveUtils.createABCFromGrooveData(GrooveData);
				var svgReturn = myGrooveUtils.renderABCtoSVG(abcNotation);
				
				document.getElementById(svgTargetId).innerHTML = "<p><pre>" + svgReturn.svg + "</pre>";
				
				myGrooveUtils.midiEventCallbacks.loadMidiDataEvent = function(myroot) { 
					var midiURL = myGrooveUtils.create_MIDIURLFromGrooveData(GrooveData, "our_MIDI");
					myGrooveUtils.loadMIDIFromURL(midiURL);
					myGrooveUtils.midiResetNoteHasChanged();
				}
	
				myGrooveUtils.AddMidiPlayerToPage(midiPlayerTargetId);
				myGrooveUtils.oneTimeInitializeMidi();
			}
			
	
			// set up the page after it has fully loaded
			window.onload = function () {
				AddGroove("groove1", 'Div=16&Title=Funk&Tempo=80&Measures=2&showMeasures=2&H=|X-x-X-x-X-x-X-x-|X-x-X-x-X-x-X-x-|&S=|-----g-o-o--x--o|-----g-o-o--x--o|&K=|o-o-------o--o--|o-o-------o--o--|');
				AddGroove("groove2", 'Div=24&Title=Rosanna Shuffle&Author=Jeff Pocaro&Tempo=85&Measures=2&showMeasures=1&H=|x-xx-xx-xx-xx-xx-xx-xx-x|xxxxxxxxxxxxxxxxxxxxxxxx|&S=|-g--g-Og--g--g--g-Og--g-|------O-----------O-----|&K=|o----o---o-o--o---o----o|o-----------o-----------|');
				AddGroove("groove3", 'Div=16&Title=Samba&Tempo=80&Measures=2&showMeasures=1&H=|xxXxxxXxxxXxxxXx|xxXxxxXxxxXxxxXx|&S=|o-o-oo-o-o-ooooo|o-o-oo-o-o-ooooo|&K=|o-ooo--oo-oooo-o|o-ooo--oo-oooo-o|');
			}
			
			
			
	</script>
	
	<div id="groove1"></div>
	
	<div id="groove2"></div>
	
	<div id="groove3"></div>
	
	
	
	